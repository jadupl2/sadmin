Debian 9 Installation Notes
on iMac
Solve python linting in image
Root .bash_profile for color prompt
-----

14 Mars 2018

Correct load db when running twice
In update_sadmin_cfg - sname = SADM_RO_DBPWD - svalue = Query18!



SADMIN Setup V1.3
------------------
Enter directory path where your install SADMIN : /opt/sadmin

----------
[OK] SADMIN Environment variable is set to /opt/sadmin
      - The line below is in /etc/environment now
      - SADMIN=/opt/sadmin
      - This will make sure it is set upon reboot
Initial sadmin.cfg file in place.
----------

----------

[SADM_HOST_TYPE]
Specify if this host is to become a SADMIN [C]lient or [S]erver.
The questions that will follow depend on this answer.
 
Host will be a SADMIN [S]erver or a [C]lient (S,C) : s

----------

[SADM_CIE_NAME]
Specify your company name. 
This name that will appear in the heading of the web interface
and on some report and email that SADMIN produce. 
Enter your Company name  : The Batcave

----------

[SADM_MAIL_ADDR]
This field specify the email address of the system administrator.
It is used by SADMIN Tools to send various email. 
For example, you can request that the log of a script be sent when an 
error occured or every time is it run. (See SADM_MAIL_TYPE later on)
Multiple email can be specify, a comma must seperate each of them. 
Enter System Administrator Email : batman@batcave.com

----------

[SADM_MAIL_TYPE]
Default option for sending email after a script is finish.
Can be overridden by changing SADM_MAIL_TYPE in the SADMIN definition section 
at the top of your script.

[0] = Never send email.
[1] = Only send the log when script finish with error.
[2] = Only send the log when script finish with success.
[3] = Always send the script log when script finish.
 
Enter default email type : 1

----------

[SADM_SERVER]
Enter the name of the SADMIN Server - (MUST be a fully qualified domain name)
This name can't be an alias in the DNS, it must be the real name of the server.
This is the server where the MySQL Database and SADMIN web site will reside.
It MUST be the result of the 'hostname' command on the SADMIN server.

 
Enter SADMIN (FQDN) server name : mdebian9.maison.ca
Validating server name

----------

[SADM_MAX_LOGLINE]
Every time a script (python or bash script) that use SADMIN Tools is run,
it produce a log, in the dedicated directory ${SADMIN}/log.
The name of the Log file is "[HOSTNAME]_sadm_[NAME_OF_SCRIPT].log".
Log file are cumulative by default, but you can decide to overwrite the 
script log if you want.
The log are automatically trimmed to this number each time the script end.

This help keeping our log to a reasonnable size.
Recommended size is 1000 lines as a starting point.

 
Maximum number of lines in LOG file : 999

----------

[SADM_MAX_RCHLINE]
When a (python or shell) script using the SADMIN tools start and ends, 
it record the date/time and the ending status of your script in what we call
a RCH file ([R]eturn [C]ode [H]istory] file). 

     - The RCH file name are "[HOSTNAME]_sadm_[NAME_OF_SCRIPT].rch"
     - They are located in the directory ${SADM_BASE_DIR}/dat/rch.
     - This number represent the maximum number of lines that each RCH file can contain.
     
Recommended value of 100 lines would keep an history of 50 days and is the default value.

 
Maximum number of lines in RCH file : 99

----------

[SADM_DOMAIN]
Enter the default Domain Name to use when you will be adding a new server.
 
Default domain name : maison.ca

----------

[SADM_GROUP]
This is the primary user group that have access to all SADMIN directories.
    - All files in the $SADMIN directories are own by this group. 
    - If others users need to access or used scripts located in $SADMIN, 
      they must be part of this group.
    - The SADMIN default user group is 'sadmin'.
    
 
Enter the default user Group : sadin
Creating group sadin

----------

[SADM_USER]
This is the main user that have access to all SADMIN directories and files.
    - This user will be assign to the user group you just specified.
    - The SADMIN default user name is 'sadmin'.
    
 
Enter the default user name : sadmin
Creating user sadmin
Executing find /opt/sadmin -exec chown sadmin.sadin {} \;

----------

[SADM_SSH_PORT]
TCP/IP Port used for SSH. 
Default port is 22.

 
SSH port number used to connect to client : 32

----------

[SADM_NETWORK1]
Every day SADMIN will check the IP utilisation on your network.
    - The result will be visible on a web page.
    - You will be able to tell what IP are in use or not (respond to ping),
      and what DNS name each IP has (if any).
    - It will facilitate, the clean up of your DNS and IP usage.
    - Network should be specify in this form, '192.168.1.0"
    - Netmask should specify the number bits use (1-31) 
Enter the network IP : 192.168.1.0

----------

[SADM_NETWORK1]
Every day SADMIN will check the IP utilisation on your network.
    - The result will be visible on a web page.
    - You will be able to tell what IP are in use or not (respond to ping),
      and what DNS name each IP has (if any).
    - It will facilitate, the clean up of your DNS and IP usage.
    - Network should be specify in this form, '192.168.1.0"
    - Netmask should specify the number bits use (1-31) 
Enter the Network Netmask [1-31] : 24


Checking SADMIN Client Packages requirement
Running apt-get update...Running apt-get update...
 Done 
Checking for nmon ... Installing nmon ... Installing nmon ... 
apt-get -y install nmon >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for bc ...  Ok 
Checking for lsb-release ...  Ok 
Checking for mailutils ... Installing mailutils ... Installing mailutils ... 
apt-get -y install mailutils >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for lshw ... Installing lshw ... Installing lshw ... 
apt-get -y install lshw >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for perl-base ...  Ok 
Checking for ethtool ... Installing ethtool ... Installing ethtool ... 
apt-get -y install ethtool >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for libdatetime-perl libwww-perl ... Installing libdatetime-perl libwww-perl ... Installing libdatetime-perl libwww-perl ... 
apt-get -y install libdatetime-perl libwww-perl >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for parted ...  Ok 
Checking for net-tools ... Installing net-tools ... Installing net-tools ... 
apt-get -y install net-tools >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for openssh-client ...  Ok 
Checking for util-linux ...  Ok 
Checking for cfg2html ... Installing cfg2html ... Installing cfg2html ... 
apt-get -y install cfg2html >>/opt/sadmin/log/sadm_setup.log 2>&1
[ERROR] Error Code is 100 - See log /opt/sadmin/log/sadm_setup.log
Error Code is 100 - See log /opt/sadmin/log/sadm_setup.log
Checking for dmidecode ...  Ok 
Checking for facter ... Installing facter ... Installing facter ... 
apt-get -y install facter >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for util-linux ...  Ok 


Checking SADMIN Server Packages requirement
Running apt-get update...Running apt-get update...
 Done 
Checking for rrdtool ... Installing rrdtool ... Installing rrdtool ... 
apt-get -y install rrdtool >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for apache2 apache2-utils ... Installing apache2 apache2-utils ... Installing apache2 apache2-utils ... 
apt-get -y install apache2 apache2-utils >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for mariadb-server mariadb-client ... Installing mariadb-server mariadb-client ... Installing mariadb-server mariadb-client ... 
apt-get -y install mariadb-server mariadb-client >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully
Checking for php php-mysql php-common ... Installing php php-mysql php-common ... Installing php php-mysql php-common ... 
apt-get -y install php php-mysql php-common >>/opt/sadmin/log/sadm_setup.log 2>&1
 Done 
Installed successfully

----------

[SADM_ROOT]
 
 
Enter MySQL Database 'root' user password :  : Icu@9am!
Testing Access to Database ...
Securing MySQL Database ...
Problem securing the database ...

----------

[SADM_RW_DBPWD]
Enter the password for the read/write user "sadmin" in the 'sadmin' database.
You can give this password to people who you want to give permission to update
the sadmin database,
 
Enter 'sadmin' database user password :  : Nimdas17!

----------

[SADM_RO_DBPWD]
Enter the password for the read only user "squery" of the 'sadmin' database.
You can give this password to people you want to access the sadmin database,
but want them to modify any information in the Database.
 
Enter 'squery' database user password :  : Squery18!
Loading SADMIN Database
Initial SADMIN Database is in place.

Set up SADMIN Web Site ...

Apache process user name is www-data
Apache user group name is www-data
Initial SADMIN Web site configuration file in place.
Return code for Enabling Web Site is 0
Return code for Disabling Default Web Site is 0
Setting Owner/Group on SADMIN WebSite files (/opt/sadmin/www)
Return code (chown) is 0
Setting access permission on SADMIN WebSite files (/opt/sadmin/www)
Return code (chown) is 0
Return code for Restarting Apache Web Server is 0


------------------------------
End of SADMIN Setup
You can now use SADMIN


TO CREATE YOUR OWN SCRIPT USING SADMIN LIBRARY
To create your own script using SADMIN, you may want to run and view the code of 
$SADMIN/bin/sadm_template.sh and $SADMIN/bin/sadm_template.py as a starting point
You may also want to run $SADMIN/lib/sadmlib_test.sh and $SADMIN/lib/sadmlib_test.py.
They will present all functions available to your shell or Python script

USE THE WEB INTERFACE TO ADMINISTRATE YOUR LINUX SERVER FARM
The web Interface is available at http://sadmin.maison.ca


------------------------------
root@mdebian9:/opt/sadmin/setup# 
